{% load static %}
{% load nominopolitan %}

<!-- List Partial - Used by HTMX for table updates -->
<div id="list-partial-container">
    <table class="table table-zebra w-full">
        <thead>
            <tr>
                {% if can_bulk_edit or can_bulk_delete %}
                <th class="w-12">
                    <label class="cursor-pointer">
                        <input type="checkbox" 
                               class="checkbox checkbox-sm"
                               id="select-all-checkbox-partial"
                               hx-post="{% url 'toggle_all_selection_view' model_name=model_name %}"
                               hx-target="#selection-status-container"
                               hx-swap="outerHTML"
                               hx-include="[name='preserved_params']"
                               {% if selected_count == object_list|length %}checked{% endif %}>
                    </label>
                </th>
                {% endif %}
                {% for column in columns %}
                <th class="{% if column.sortable %}cursor-pointer{% endif %}">
                    {% if column.sortable %}
                        <a href="{% url 'list' %}{{ preserved_params }}&sort={{ column.name }}{% if sort == column.name and direction == 'asc' %}&direction=desc{% else %}&direction=asc{% endif %}"
                           class="flex items-center">
                            {{ column.label }}
                            {% if sort == column.name %}
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    {% if direction == 'asc' %}
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
                                    {% else %}
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                    {% endif %}
                                </svg>
                            {% endif %}
                        </a>
                    {% else %}
                        {{ column.label }}
                    {% endif %}
                </th>
                {% endfor %}
                <th class="w-24">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for object in object_list %}
            <tr>
                {% if can_bulk_edit or can_bulk_delete %}
                <td>
                    <label class="cursor-pointer">
                        <input type="checkbox" 
                               class="checkbox checkbox-sm row-checkbox"
                               value="{{ object.pk }}"
                               hx-post="{% url 'toggle_selection_view' model_name=model_name %}"
                               hx-target="#selection-status-container"
                               hx-swap="outerHTML"
                               hx-include="[name='preserved_params']"
                               {% if object.pk in selected_ids %}checked{% endif %}>
                    </label>
                </td>
                {% endif %}
                {% for column in columns %}
                <td>
                    {% if column.name == 'action_links' %}
                        {% action_links object %}
                    {% else %}
                        {{ column.render|default:object|getattr:column.name }}
                    {% endif %}
                </td>
                {% endfor %}
                <td>
                    <div class="flex space-x-1">
                        {% action_links object %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <!-- Hidden preserved parameters -->
    <input type="hidden" name="preserved_params" value="{{ preserved_params|default:'' }}">
</div>